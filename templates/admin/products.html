{% extends "layout.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h5 class="mb-0"><i class="fa-solid fa-boxes-stacked me-2"></i> المنتجات</h5>
  <a class="btn btn-brand" href="{{ url_for('admin_product_new') }}"><i class="fa-solid fa-plus"></i> منتج جديد</a>
</div>

<div class="table-responsive">
  <table class="table align-middle">
    <thead>
      <tr>
        <th>المنتج</th><th>السعر</th><th>العمولة</th><th>التوصيل</th><th>التصنيف</th><th class="text-end">إجراء</th>
      </tr>
    </thead>
    <tbody>
      {% for p in products %}
      <tr>
        <td class="d-flex align-items-center gap-2">
          <img src="{{ static_url(p.image_path) }}" width="48" class="rounded">
          <div class="small">
            <div class="fw-semibold">{{ p.name }}</div>
            <div class="text-muted">{{ (p.description or '')[:50] }}{% if (p.description or '')|length>50 %}…{% endif %}</div>
          </div>
        </td>
        <td>{{ p.price|int }}</td>
        <td>{{ p.commission|int }}</td>
        <td>{{ 'منزل' if p.delivery_mode=='home' else 'مكتب' }} / {{ p.delivery_price|int }}</td>
        <td>{{ p.category_name or '—' }}</td>
        <td class="text-end">
          <a class="btn btn-outline-dark btn-sm" href="{{ url_for('admin_product_edit', pid=p.id) }}"><i class="fa-regular fa-pen-to-square"></i></a>
          <form action="{{ url_for('admin_products_delete', pid=p.id) }}" method="post" class="d-inline" onsubmit="return confirm('حذف المنتج؟');">
            <button class="btn btn-outline-danger btn-sm"><i class="fa-regular fa-trash-can"></i></button>
          </form>
        </td>
      </tr>
      {% else %}
      <tr><td colspan="6" class="text-center text-muted">لا توجد منتجات.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
